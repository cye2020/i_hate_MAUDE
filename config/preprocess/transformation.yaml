# ============================================
# 타입 변환 및 인코딩 설정
# ============================================

# 타입 변환
type_conversion:
  # 날짜형
  date_columns:
    - "date_of_event"
    - "date_received"
    - "date_report"
    - "device_0_date_received"
    - "publish_date"
  
  date_format: "%Y%m%d"
  
  # 숫자형
  numeric_columns:
    - "device_0_device_age_text"
    - "patient_0_patient_age"
    - "patient_0_patient_weight"
  
  # Boolean
  boolean_columns:
    - "remedial_action"
    - "removal_correction_number"
  
  boolean_mapping:
    true_values: ["Y", "YES", "TRUE", "1"]
    false_values: ["N", "NO", "FALSE", "0"]

# Categorical 인코딩
categorical_encoding:
  # 자동 감지
  auto_detect:
    enabled: true
    max_cardinality: 100
    min_frequency: 10
  
  # 명시적 지정
  categorical_columns:
    - "report_source_code"
    - "event_type"
    - "device_0_device_report_product_code"
    - "manufacturer_d_country"
    - "patient_0_sequence_number_outcome"
  
  # 메모리 최적화
  optimize_memory: true
  log_memory_savings: true

# Flag 처리
flag_processing:
  # 재처리 플래그
  reprocessed_flag:
    source_column: "reprocessed_and_reused_flag"
    create_raw_backup: true
    create_binary: true
    
    mapping:
      "Y": 1
      "N": 0
  
  # 일괄 처리 플래그
  binary_flags:
    - "single_use_flag"
    - "remedial_action"
  
  # 파생 플래그
  derived_flags:
    - name: "has_udi"
      condition: "udi_di IS NOT NULL OR udi_public IS NOT NULL"
      
    - name: "has_patient_info"
      condition: "patient_0_patient_sequence_number IS NOT NULL"
      
    - name: "is_recalled"
      condition: "removal_correction_number IS NOT NULL"

# String 최적화
string_optimization:
  enabled: true
  method: "categorical"
  cardinality_threshold: 50